<!doctype html> <html lang="en" class="no-js"> <head> <meta charset="utf-8"> <title>Flashing Georgi Firmware | Floor and Varnish</title> <meta name="description" content="Make your steno keyboard do your bidding by codifying your preferences."> <meta name="author" content="Paul Fioravanti"> <meta property="article:author" content="Paul Fioravanti"> <meta property="og:type" content="article"> <meta property="og:locale" content="en_US"> <meta property="og:site_name" content="Floor and Varnish"> <meta property="og:title" content="Flashing Georgi Firmware"> <meta property="og:url" content="https://www.paulfioravanti.com/blog/flashing-georgi-firmware/"> <meta property="og:description" content="Make your steno keyboard do your bidding by codifying your preferences."> <meta property="og:image" content="https://www.paulfioravanti.com/assets/images/2022-05-18/alexandre-debieve-FO7JIlwjOtU-unsplash.jpg"> <meta name="twitter:site" content="@paulfioravanti"> <meta name="twitter:title" content="Flashing Georgi Firmware"> <meta name="twitter:description" content="Make your steno keyboard do your bidding by codifying your preferences."> <meta name="twitter:url" content="https://www.paulfioravanti.com/blog/flashing-georgi-firmware/"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:image" content="https://www.paulfioravanti.com/assets/images/2022-05-18/alexandre-debieve-FO7JIlwjOtU-unsplash.jpg"> <meta name="twitter:creator" content="@paulfioravanti"> <meta property="article:published_time" content="2022-05-18T16:00:00+10:00"> <meta property="article:modified_time" content="2022-05-19T08:20:00+10:00"> <link rel="canonical" href="https://www.paulfioravanti.com/blog/flashing-georgi-firmware/"> <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Paul Fioravanti",
      "url": "https://www.paulfioravanti.com/",
      "sameAs": ["https://twitter.com/paulfioravanti","https://www.linkedin.com/in/paulfioravanti","https://github.com/paulfioravanti","https://stackoverflow.com/users/567863/paul-fioravanti"]
    
  }
</script> <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Floor and Varnish Feed"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <script>document.documentElement.className=document.documentElement.className.replace(/\bno-js\b/g,"")+" js ";</script> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript> </head> <body class="layout--single wide"> <nav class="skip-links"> <ul> <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li> <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li> <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li> </ul> </nav> <!--[if lt IE 9]><div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]--> <div class="masthead"> <div class="masthead__inner-wrap"> <div class="masthead__menu"> <nav id="site-nav" class="greedy-nav"> <a class="site-title" href="/"> Floor and Varnish </a> <ul class="visible-links"><li class="masthead__menu-item"> <a href="/about/">About</a> </li></ul> <button class="search__toggle" type="button"> <span class="visually-hidden">Toggle search</span> <i class="fas fa-search"></i> </button> <button class="greedy-nav__toggle hidden" type="button"> <span class="visually-hidden">Toggle menu</span> <div class="navicon"></div> </button> <ul class="hidden-links hidden"></ul> </nav> </div> </div> </div> <div class="initial-content"> <div class="page__hero--overlay" style=" background-image: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('/assets/images/2022-05-18/alexandre-debieve-FO7JIlwjOtU-unsplash.jpg');"> <div class="wrapper"> <h1 id="page-title" class="page__title" itemprop="headline"> Flashing Georgi Firmware </h1> <p class="page__lead">Make your steno keyboard do your bidding by codifying your preferences. </p> <p class="page__meta"> <span class="page__meta-date"> <i class="far fa-calendar-alt" aria-hidden="true"></i> <time datetime="2022-05-18T16:00:00+10:00">May 18, 2022</time> </span> <span class="page__meta-sep"></span> <span class="page__meta-readtime"> <i class="far fa-clock" aria-hidden="true"></i> 9 minute read </span> </p> </div> <span class="page__hero-caption">Photo by <a href="https://unsplash.com/@alexkixa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Alexandre Debi√®ve</a> on <a href="https://unsplash.com/s/photos/hardware?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a> </span> </div> <div id="main" role="main"> <div class="sidebar sticky"> <div itemscope itemtype="https://schema.org/Person"> <div class="author__avatar"> <a href="/"> <img src="https://s.gravatar.com/avatar/abda861707b1e78e0fce47ced55f84ee" alt="Paul Fioravanti" itemprop="image"> </a> </div> <div class="author__content"> <a href="/"><h3 class="author__name" itemprop="name">Paul Fioravanti</h3></a> <div class="author__bio" itemprop="description"> <p><img class="emoji" title=":heart:" alt=":heart:" src="https://github.githubassets.com/images/icons/emoji/unicode/2764.png" height="20" width="20"> code / <img class="emoji" title=":heart:" alt=":heart:" src="https://github.githubassets.com/images/icons/emoji/unicode/2764.png" height="20" width="20"> languages <img class="emoji" title=":it:" alt=":it:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f1ee-1f1f9.png" height="20" width="20"> <img class="emoji" title=":jp:" alt=":jp:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f1ef-1f1f5.png" height="20" width="20"> / <img class="emoji" title=":heart:" alt=":heart:" src="https://github.githubassets.com/images/icons/emoji/unicode/2764.png" height="20" width="20"> mech <img class="emoji" title=":keyboard:" alt=":keyboard:" src="https://github.githubassets.com/images/icons/emoji/unicode/2328.png" height="20" width="20"> / Learning stenography</p> </div> </div> <div class="author__urls-wrapper"> <button class="btn btn--inverse">Follow</button> <ul class="author__urls social-icons"> <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place"> <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Sydney, Australia</span> </li> <li> <a href="https://www.paulfioravanti.com" itemprop="url"> <i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span> </a> </li> <li> <a href="mailto:paul@paulfioravanti.com"> <meta itemprop="email" content="paul@paulfioravanti.com"> <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span> </a> </li> <li> <a href="https://keybase.io/paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fas fa-fw fa-key" aria-hidden="true"></i><span class="label">Keybase</span> </a> </li> <li> <a href="https://twitter.com/paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span> </a> </li> <li> <a href="https://www.linkedin.com/in/paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span> </a> </li> <li> <a href="https://instagram.com/paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span> </a> </li> <li> <a href="https://github.com/paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span> </a> </li> <li> <a href="https://stackoverflow.com/users/567863/paul-fioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">Stack Overflow</span> </a> </li> <li> <a href="https://www.youtube.com/@paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-youtube" aria-hidden="true"></i><span class="label">YouTube</span> </a> </li> <li> <a href="https://www.strava.com/athletes/paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer me"> <i class="fab fa-strava" aria-hidden="true"></i> Strava </a> </li> </ul> </div> </div> <div id="bd_embed_signup"> <form action="https://buttondown.email/api/emails/embed-subscribe/paulfioravanti" method="post" target="popupwindow" onsubmit="window.open('https://buttondown.email/paulfioravanti', 'popupwindow')" class="embeddable-buttondown-form"> <label for="bd-email">Get notified of new posts!</label> <input type="email" name="email" id="bd-email" class="email" placeholder="email address"> <input type="hidden" value="1" name="embed"> <div class="clear"> <input type="submit" value="Subscribe" id="bd-embedded-subscribe" class="button"> </div> <p> I send email when I have new content to share. No spam; unsubscribe at any time. <a href="/privacy">Privacy Policy</a> </p> </form> </div> </div> <article class="page" itemscope itemtype="https://schema.org/CreativeWork"> <meta itemprop="headline" content="Flashing Georgi Firmware"> <meta itemprop="description" content="Make your steno keyboard do your bidding by codifying your preferences."> <meta itemprop="datePublished" content="2022-05-18T16:00:00+10:00"> <meta itemprop="dateModified" content="2022-05-19T08:20:00+10:00"> <div class="page__inner-wrap"> <section class="page__content" itemprop="text"> <p>So, you have had your <a href="https://www.gboards.ca/product/georgi">Georgi</a> keyboard for a while, done lots of <a href="https://www.openstenoproject.org/plover/">Plover</a> <a href="https://en.wikipedia.org/wiki/Stenotype">stenography</a> practice, and are now thinking about making some changes to its keymap layout because you want it to do something that it currently does not.</p> <div class="centered-image" style="width: 90%"> <figure> <img src="/assets/images/2022-05-18/georgi.jpg" alt="Georgi keyboard"> </figure> </div> <p>This will require you to generate some <a href="https://docs.qmk.fm/#/">Quantum Mechanical Keyboard (QMK)</a>-based <a href="https://en.wikipedia.org/wiki/Firmware">firmware</a> for the Georgi, and then <a href="https://en.wikipedia.org/wiki/Firmware#Flashing">flash</a> the device to overwrite the one that is currently there.</p> <blockquote> <p>See a previous blog post I wrote, <em><a href="https://www.paulfioravanti.com/blog/escape-defaults-control-keyboard-qmk/">Escape the defaults and Control your keyboard with QMK</a></em>, for more information about using QMK: some general, some more <a href="https://ergodox-ez.com/">Ergodox EZ</a>-focused.</p> </blockquote> <p>QMK has a <a href="https://config.qmk.fm/#">web-based configurator</a>, which enables you to create firmware files for a multitude of keyboards that QMK supports, without having to touch any <a href="https://en.wikipedia.org/wiki/C_(programming_language)">C</a> code. But, in the configurator<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>‚Ä¶</p> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/qmk-configurator.jpg" alt="QMK Configurator"> </figure> </div> <ul> <li>Compilation of the <a href="https://config.qmk.fm/#/gboards/georgi/LAYOUT_georgi">Georgi layout</a> is not yet supported</li> <li> <a href="https://docs.qmk.fm/#/feature_stenography?id=keycode-reference">Stenography keycodes</a> are not yet available to assign to keys</li> </ul> <p>If you still want to make any changes, steel yourself for hard mode, because we are going to have to get technical.</p> <p>Before we even think about firmware customisation, though, we will want to make sure that you can compile the <em>default</em> Georgi firmware locally on your computer, and flash your Georgi successfully with it. <em>Then</em>, we will get our hands dirty with some code by creating an example firmware customisation, compiling it, and then flash the Georgi again to apply it.</p> <p>If you have not already, I would recommend familiarising yourself, at least a little bit, with some of the Georgi-related <a href="http://docs.gboards.ca/">gBoards documentation</a>, to provide some context on what we will be doing. Specifically:</p> <ul> <li> <a href="http://docs.gboards.ca/docs/Unboxing-Georgi/">Unboxing Georgi</a> - we will use the <a href="http://docs.gboards.ca/docs/Unboxing-Georgi/#entering-qmk-gaming-mode">Gaming mode</a> in the example customisation later on</li> <li> <a href="http://docs.gboards.ca/docs/Configuring-Georgi/">Configuring Georgi</a> - in particular <a href="http://docs.gboards.ca/docs/Configuring-Georgi/#triggers">Triggers</a>, one of which we will change</li> <li> <a href="http://docs.gboards.ca/docs/Hacking-Georgi/">Hacking Georgi</a> - here, just note that we will be working with the <a href="http://docs.gboards.ca/docs/Hacking-Georgi/#cchord"><code class="language-plaintext highlighter-rouge">cChord</code></a> <a href="https://en.wikipedia.org/wiki/Bit_field">bit field</a> </li> </ul> <p>Ready? Let‚Äôs get hacking!</p> <h2 id="compile-default-georgi-firmware">Compile Default Georgi Firmware</h2> <p>Download the QMK firmware from its <a href="https://github.com/qmk/qmk_firmware">GitHub repository</a>. Pick a convenient directory to start in (I will use <code class="language-plaintext highlighter-rouge">~/Desktop</code> here, but you can pick one appropriate for your operating system), and either use <a href="https://git-scm.com/">Git</a> to get the source code (recommended), or download its <a href="https://en.wikipedia.org/wiki/ZIP_(file_format)">ZIP</a> file.</p> <div class="centered-image" style="width: 100%"> <figure style="margin-bottom: 0"> <img src="/assets/images/2022-05-18/qmk-firmware-github.jpg" alt="QMK Firmware GitHub page"> </figure> </div> <p>Example commands:</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">cd ~/Desktop
git clone https://github.com/qmk/qmk_firmware.git
cd qmk_firmware
</span></code></pre></div></div> <p>Next, follow the <a href="https://docs.qmk.fm/#/newbs_getting_started">Setting Up Your QMK Environment</a> instructions from the <a href="https://docs.qmk.fm/#/">QMK documentation</a> and install the <code class="language-plaintext highlighter-rouge">qmk</code> <a href="https://en.wikipedia.org/wiki/Command-line_interface">command line interface</a> (CLI) application.</p> <p>In the <a href="https://docs.qmk.fm/#/newbs_getting_started?id=_1-prerequisites">Prerequisites</a>, it says installation of the <a href="https://github.com/qmk/qmk_toolbox">QMK Toolbox</a> is optional, but we will be using it soon, so either download <a href="https://github.com/qmk/qmk_toolbox/releases">the latest release</a>, or, if you are on macOS, use <a href="https://brew.sh/">Homebrew</a> to install it:</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">brew install qmk-toolbox
</span></code></pre></div></div> <p>Now, use the <code class="language-plaintext highlighter-rouge">qmk</code> CLI to compile the default Georgi firmware with the following command:</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">qmk compile -kb georgi -km default
</span></code></pre></div></div> <blockquote> <p>You may get an error running this command the first time, and be prompted to run a command like <code class="language-plaintext highlighter-rouge">make git-submodule</code>. Follow any error message instructions, and then try compiling again.</p> </blockquote> <p>If the command runs successfully, the end of all of the compilation output should look something like this:</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">...
</span><span class="go">Creating load file for flashing: .build/gboards_georgi_default.hex          [OK]
Copying gboards_georgi_default.hex to qmk_firmware folder                   [OK]
Checking file size of gboards_georgi_default.hex                            [OK]
</span></code></pre></div></div> <p>If you check in your <code class="language-plaintext highlighter-rouge">qmk_firmware</code> directory, you will see that a <a href="https://en.wikipedia.org/wiki/Intel_HEX">HEX</a> file named <code class="language-plaintext highlighter-rouge">gboards_georgi_default.hex</code> has been generated, which we will use to flash the Georgi.</p> <h2 id="flash-georgi-firmware">Flash Georgi Firmware</h2> <p>Open up the QMK Toolbox application, press the ‚ÄúOpen‚Äù button, and select the generated HEX file.</p> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/qmk-toolbox-select-firmware.jpg" alt="QMK Toolbox Select Firmware"> <figcaption> Screenshot is macOS version of QMK Toolbox. May differ slightly for other operating systems. </figcaption> </figure> </div> <p>You will notice that the ‚ÄúFlash‚Äù button is currently not selectable. This is because the Georgi is not currently in <a href="https://en.wikipedia.org/wiki/USB#Device_Firmware_Upgrade_mechanism">Device Firmware Upgrade</a> (DFU) mode. To get in DFU mode, and allow the Georgi to receive firmware, you need to press the tiny button on the left half of the keyboard, just below the <a href="https://en.wikipedia.org/wiki/Phone_connector_(audio)">TRRS</a> cable plug. I use a paperclip or a <a href="https://en.wikipedia.org/wiki/SIM_card">SIM card</a> tray ejector tool for this delicate job.</p> <div class="centered-image" style="width: 80%"> <figure> <img src="/assets/images/2022-05-18/georgi-flash-button.jpg" alt="Press button to put Georgi in DFU mode"> <figcaption> Tray ejector tools are not just for mobile phones. </figcaption> </figure> </div> <p>Once the button has been pressed, QMK Toolbox will show you a message letting you know that you have successfully connected a device in DFU mode, and the ‚ÄúFlash‚Äù button will become pressable:</p> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/qmk-toolbox-dfu-device-connected.jpg" alt="QMK Toolbox DFU mode device successfully connected"> </figure> </div> <p>Press the ‚ÄúFlash‚Äù button, and if everything goes well, you should see output that looks something like this:</p> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/qmk-toolbox-flashing-successful.jpg" alt="QMK Toolbox device successfully flashed"> </figure> </div> <p>The Georgi has now been taken out of DFU mode, and can be reconnected to Plover.</p> <div class="centered-image" style="width: 60%"> <figure> <img src="/assets/images/2022-05-18/reconnect-plover.jpg" alt="Reconnect Georgi to Plover"> <figcaption> My Georgi shows up as <code>/dev/cu.usbmodem14202</code> in Plover's connection list, but yours might look something like <code>COM6</code> if you use Windows. </figcaption> </figure> </div> <p>If you are able to stroke steno chords again (and it seems like nothing has changed), congratulations, you have just completed a full keyboard flashing process! You will get another chance to do this again, but before that, let‚Äôs actually go and make some firmware changes!</p> <h2 id="customising-the-firmware">Customising the Firmware</h2> <p>Before diving straight into the code, allow me to provide some context around the reasons for even wanting to make the changes we will use in the customisation example.</p> <h3 id="the-problem">The Problem</h3> <p>I have been experimenting with Georgi‚Äôs <a href="http://docs.gboards.ca/docs/Unboxing-Georgi/#entering-qmk-gaming-mode">Gaming mode</a>, which switches you to a separate keyboard layer that ‚Äúacts like a traditional keyboard, as opposed to stenotype‚Äù, in the way it sends information to your computer.</p> <p>This is different to Georgi‚Äôs <a href="http://docs.gboards.ca/docs/Unboxing-Georgi/#modes">QWERTY and Symbol modes</a>, which still both act like a stenotype, and actually only exist as <a href="http://docs.gboards.ca/docs/Configuring-Georgi/#layers">‚Äúpseudo-layers‚Äù</a> within the main steno keymap layer.</p> <blockquote> <p>Open any game you may have that involves moving a character around a screen, and attempt to do so using Georgi‚Äôs QWERTY mode. You will most likely be unable to, due to this keyboard/stenotype difference (details of which are not important for this post).</p> </blockquote> <p>If you have a look at the code for the Georgi <a href="https://github.com/qmk/qmk_firmware/blob/e9e83b4da73e5594b1f864d78529e85aa5ebefe9/keyboards/gboards/georgi/keymaps/default/keymap.c#L219">default keymap layers</a>, you will actually see only three layers, which have the following layouts:</p> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/georgi-steno-layer.png" alt="Steno (and QWERTY and Symbol) layer"> <figcaption> Steno Layer (includes QWERTY and Symbol pseudo-layers; not shown above, but you can view them <a href="http://docs.gboards.ca/docs/Unboxing-Georgi/#modes">here</a>) </figcaption> </figure> </div> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/georgi-gaming-layer-1.png" alt="Gaming Layer 1"> <figcaption> Gaming Layer 1 </figcaption> </figure> </div> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/georgi-gaming-layer-2.png" alt="Gaming Layer 2"> <figcaption> Gaming Layer 2 </figcaption> </figure> </div> <p>In order to change from the Steno layer to Gaming layer 1, the default chord is:</p> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/georgi-steno-layer-gaming-chord.png" alt="Enter Gaming Mode chord"> <figcaption> Enter Gaming Mode chord </figcaption> </figure> </div> <p>In order to change from a Gaming layer to the Steno layer, the default keystroke is:</p> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/georgi-gaming-layer-steno-key.png" alt="Return to Steno Mode key"> <figcaption> Return to Steno Mode key </figcaption> </figure> </div> <p>My brain sees this as stroking a complex chord to change to Gaming Mode, yet pressing a completely different singular key to change back to Steno Mode. I would prefer to:</p> <ul> <li>have a single chord that that would feel like a ‚Äútoggle‚Äù between Steno and Gaming modes</li> <li>make that chord a little bit simpler than the one above</li> </ul> <h3 id="the-solution">The Solution</h3> <p>I do not want to risk any dictionary-level outline conflicts, so the chord has to include a Georgi-specific key (<code class="language-plaintext highlighter-rouge">FN</code> or <code class="language-plaintext highlighter-rouge">PWR</code>). Therefore, I am thinking a <code class="language-plaintext highlighter-rouge">PWR | ST4</code> (‚ÄúStar 4‚Äù) combination will be a good candidate:</p> <div class="centered-image" style="width: 100%"> <figure> <img src="/assets/images/2022-05-18/georgi-simple-gaming-chord.png" alt="Steno/Gaming toggle chord"> <figcaption> Candidate Steno/Gaming "toggle" chord </figcaption> </figure> </div> <p>The plan of attack to implement this toggle chord will be twofold:</p> <ul> <li>Change the hardcoded Georgi Gaming layer <a href="http://docs.gboards.ca/docs/Configuring-Georgi/#triggers">trigger</a> on the Steno layer to be <code class="language-plaintext highlighter-rouge">PWR | ST4</code> </li> <li>Create an equivalent <a href="https://github.com/qmk/qmk_firmware/blob/master/docs/feature_combo.md">QMK Combo</a> shape (read: chord for a QWERTY keyboard) on the Gaming layer that returns to the Steno layer, using the ‚ÄúLeft Control‚Äù and ‚ÄúH‚Äù keys</li> </ul> <p>Let‚Äôs give it a try!</p> <h3 id="change-gaming-layer-trigger">Change Gaming Layer Trigger</h3> <p>You will find all the logic for the triggers related to layer switching in Georgi‚Äôs <a href="https://github.com/qmk/qmk_firmware/blob/656090335066eed90a9b76e113fb93ee3bc8c089/keyboards/gboards/georgi/sten.c#L97"><code class="language-plaintext highlighter-rouge">sten.c</code></a> file. Inside the <code class="language-plaintext highlighter-rouge">send_steno_chord_user</code> function, you can see that the chord for the gaming toggle is currently hardcoded to <code class="language-plaintext highlighter-rouge">(PWR | FN | ST4 | ST3)</code>, as per the keymap above:</p> <p><strong><code class="language-plaintext highlighter-rouge">qmk_firmware/keyboards/gboards/georgi/sten.c</code></strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// All processing done at chordUp goes through here</span>
<span class="n">bool</span> <span class="nf">send_steno_chord_user</span><span class="p">(</span><span class="n">steno_mode_t</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">chord</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="c1">// Handle Gaming Toggle,</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cChord</span> <span class="o">==</span> <span class="p">(</span><span class="n">PWR</span> <span class="o">|</span> <span class="n">FN</span> <span class="o">|</span> <span class="n">ST4</span> <span class="o">|</span> <span class="n">ST3</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">keymapsCount</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
        <span class="n">layer_on</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div> <p>All we need to do here is change the chord that <code class="language-plaintext highlighter-rouge">cChord</code> is checked against from <code class="language-plaintext highlighter-rouge">(PWR | FN | ST4 | ST3)</code> to <code class="language-plaintext highlighter-rouge">(PWR | ST4)</code>:</p> <p><strong><code class="language-plaintext highlighter-rouge">qmk_firmware/keyboards/gboards/georgi/sten.c</code></strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// All processing done at chordUp goes through here</span>
<span class="n">bool</span> <span class="nf">send_steno_chord_user</span><span class="p">(</span><span class="n">steno_mode_t</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">chord</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="c1">// Handle Gaming Toggle,</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cChord</span> <span class="o">==</span> <span class="p">(</span><span class="n">PWR</span> <span class="o">|</span> <span class="n">ST4</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">keymapsCount</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
        <span class="n">layer_on</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div> <p>Made the change? Great! That wasn‚Äôt too scary, right? Now to move out of Georgi‚Äôs core firmware logic, and into the keymap logic, where most customisation typically occurs.</p> <h3 id="create-steno-layer-combo">Create Steno Layer Combo</h3> <p>Although we could not avoid changing core Georgi firmware logic in the previous step, the general rule when you create your own personal keymap customisations is to make a copy of the keymap directory you intend to change (in this case Georgi‚Äôs <code class="language-plaintext highlighter-rouge">default</code> keymap), and give it a unique name (in this case, I‚Äôll name it <code class="language-plaintext highlighter-rouge">my_keymap</code>: unique, yet uncreative [feel free to name it as you wish]).</p> <p>You can create the new directory via your <a href="https://en.wikipedia.org/wiki/File_manager">file manager</a> user interface, or by the command line:</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">cp -r keyboards/gboards/georgi/keymaps/default/ keyboards/gboards/georgi/keymaps/my_keymap/
</span></code></pre></div></div> <p>Now, open up the <code class="language-plaintext highlighter-rouge">keymap.c</code> file in the new <code class="language-plaintext highlighter-rouge">my_keymap</code> directory. Just above the keymap definitions, add the following code to define a new QMK Combo, which will mimic the Steno layer <code class="language-plaintext highlighter-rouge">(PWR | ST4)</code> chord we saw earlier, using the ‚ÄúLeft Control‚Äù and ‚ÄúH‚Äù keys:</p> <p><strong><code class="language-plaintext highlighter-rouge">qmk_firmware/keyboards/gboards/georgi/keymaps/my_keymap/keymap.c</code></strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="k">enum</span> <span class="n">combos</span> <span class="p">{</span>
  <span class="n">GOTO_STENO_LAYER</span>
<span class="p">};</span>

<span class="c1">// NOTE: This combo is meant to mirror the chord used to switch to the gaming</span>
<span class="c1">// layer in `sten.c`.</span>
<span class="k">const</span> <span class="kt">uint16_t</span> <span class="n">PROGMEM</span> <span class="n">goto_steno_layer_combo</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">KC_LEFT_CTRL</span><span class="p">,</span> <span class="n">KC_H</span><span class="p">,</span> <span class="n">COMBO_END</span>
<span class="p">};</span>

<span class="n">combo_t</span> <span class="n">key_combos</span><span class="p">[</span><span class="n">COMBO_COUNT</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">GOTO_STENO_LAYER</span><span class="p">]</span> <span class="o">=</span> <span class="n">COMBO</span><span class="p">(</span><span class="n">goto_steno_layer_combo</span><span class="p">,</span> <span class="n">TO</span><span class="p">(</span><span class="n">STENO_LAYER</span><span class="p">)),</span>
<span class="p">};</span>

<span class="c1">// ..</span>
<span class="k">const</span> <span class="kt">uint16_t</span> <span class="n">PROGMEM</span> <span class="n">keymaps</span><span class="p">[][</span><span class="n">MATRIX_ROWS</span><span class="p">][</span><span class="n">MATRIX_COLS</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// ..</span>
<span class="p">};</span>
</code></pre></div></div> <blockquote> <p>If you need a primer on QMK Combos, I wrote about them in excruciating detail in another blog post, <a href="https://www.paulfioravanti.com/blog/chording-qwerty-qmk-combos/">Chording QWERTY with QMK Combos</a>. Most of the information in there should still be current as of this writing.</p> </blockquote> <p>What we are doing here at a high level is:</p> <ul> <li>Giving a <em>name</em> to the chord, in the form of an <a href="https://en.wikipedia.org/wiki/Enumerated_type">enumerated type</a>, that indicates what it does: <code class="language-plaintext highlighter-rouge">GOTO_STENO_LAYER</code> </li> <li>Defining what keys the combo should consist of: the <code class="language-plaintext highlighter-rouge">KC_LEFT_CTRL</code>, and <code class="language-plaintext highlighter-rouge">KC_H</code> keys</li> <li>Defining what should happen when the chord is pressed: in this case <code class="language-plaintext highlighter-rouge">TO(STENO_LAYER)</code>, meaning to ‚Äúturn on‚Äù the Steno layer</li> </ul> <p>Next, we need to provide a definition for <code class="language-plaintext highlighter-rouge">COMBO_COUNT</code> above, which will need to be put inside a new <code class="language-plaintext highlighter-rouge">config.h</code> file within the keymap directory, so create that now:</p> <p><strong><code class="language-plaintext highlighter-rouge">qmk_firmware/keyboards/gboards/georgi/keymaps/my_keymap/config.h</code></strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"../../config.h"</span><span class="cp">
</span>
<span class="cp">#define COMBO_COUNT 1
</span></code></pre></div></div> <blockquote> <p>If you add or remove combos in the future, you will also need to change this number accordingly.</p> </blockquote> <p>Finally, we need to actually enable the use of combos in our layout, otherwise we will get compilation errors for using things like <code class="language-plaintext highlighter-rouge">combo_t</code> and <code class="language-plaintext highlighter-rouge">COMBO_END</code> above. Just add the following line of configuration to the keymap <code class="language-plaintext highlighter-rouge">rules.mk</code> file:</p> <p><strong><code class="language-plaintext highlighter-rouge">qmk_firmware/keyboards/gboards/georgi/keymaps/my_keymap/rules.mk</code></strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp"># ...
</span><span class="n">COMBO_ENABLE</span> <span class="o">=</span> <span class="n">yes</span>
</code></pre></div></div> <p>You have now done everything needed to implement the Gaming layer ‚Äútoggle‚Äù chord! Time to make sure everything compiles correctly:</p> <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">qmk compile -kb georgi -km my_keymap
</span></code></pre></div></div> <p>Now, if you check in your <code class="language-plaintext highlighter-rouge">qmk_firmware</code> directory, you will see a newly created HEX file named <code class="language-plaintext highlighter-rouge">gboards_georgi_my_keymap.hex</code> for you to use when flashing. Different keymap compilations generate a separate firmware file.</p> <p>If you get any errors, trace back and see if you may have missed a step, or perhaps made a mistake in the code. If you get similar output to when you compiled the <code class="language-plaintext highlighter-rouge">default</code> keymap, then you are ready to flash your Georgi again. Repeat the firmware flashing steps from above, and give it a test!</p> <p>If you want to see what other customisations can be made with Georgi Gaming layers, feel free to use <a href="https://github.com/paulfioravanti/qmk_keymaps/blob/master/keyboards/gboards/georgi/keymaps/paulfioravanti/README.md">my Georgi keymap</a> as a reference for any potential additions you may like to make to your own keymaps.</p> <p>If you do create your own custom layers, please share them publicly so every other Georgi owner can benefit from them as well! Good luck with your adventures in firmware!</p> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:1" role="doc-endnote"> <p>As of QMK Configurator API v0.1¬†<a href="#fnref:1" class="reversefootnote" role="doc-backlink">‚Ü©</a></p> </li> </ol> </div> </section> <footer class="page__meta"> <p class="page__taxonomy"> <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong> <span itemprop="keywords"> <a href="/tags/mechanical-keyboard" class="page__taxonomy-item" rel="tag">mechanical-keyboard</a><span class="sep">, </span> <a href="/tags/qmk" class="page__taxonomy-item" rel="tag">qmk</a><span class="sep">, </span> <a href="/tags/steno" class="page__taxonomy-item" rel="tag">steno</a> </span> </p> <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2022-05-19">May 19, 2022</time></p> </footer> <section class="page__share"> <h4 class="page__share-title">Share on</h4> <a href="https://twitter.com/intent/tweet?via=paulfioravanti&amp;text=Flashing+Georgi+Firmware%20https%3A%2F%2Fwww.paulfioravanti.com%2Fblog%2Fflashing-georgi-firmware%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.paulfioravanti.com%2Fblog%2Fflashing-georgi-firmware%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fwww.paulfioravanti.com%2Fblog%2Fflashing-georgi-firmware%2F&amp;title=Flashing%20Georgi%20Firmware" class="btn btn--reddit" title="Share on Reddit"><i class="fab fa-fw fa-reddit" aria-hidden="true"></i><span> Reddit</span></a> <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.paulfioravanti.com%2Fblog%2Fflashing-georgi-firmware%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a> </section> <nav class="pagination"> <a href="/blog/classic-doom-mac/" class="pagination--pager" title="Play Classic Doom on a Mac ">Previous</a> <a href="/blog/steno-gaming-doom-typist/" class="pagination--pager" title="Steno Gaming: Doom Typist ">Next</a> </nav> </div> <div class="page__comments"> <h4 class="page__comments-title">Leave a comment</h4> <section id="disqus_thread"></section> </div> </article> <div class="page__related"> <h4 class="page__related-title">You may also enjoy</h4> <div class="grid__wrapper"> <div class="grid__item"> <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork"> <div class="archive__item-teaser"> <img src="/assets/images/2024-02-04/doc-brown-cable-connect.jpg" alt="Doc Brown from the movie Back to the Future connecting a plug and socket"> </div> <h2 class="archive__item-title no_toc" itemprop="headline"> <a href="/blog/creating-plover-plugins-python/" rel="permalink">Creating Plover Plugins with Python </a> </h2> <p class="page__meta"> <span class="page__meta-date"> <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> <time datetime="2024-02-04T21:35:00+11:00">February 4, 2024</time> </span> <span class="page__meta-sep"></span> <span class="page__meta-readtime"> <i class="far fa-fw fa-clock" aria-hidden="true"></i> 43 minute read </span> </p> <p class="archive__item-excerpt" itemprop="description">Level up your steno chording with the power of Python! Hook into Plover plugins, and discover a world beyond keystrokes. </p> </article> </div> <div class="grid__item"> <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork"> <div class="archive__item-teaser"> <img src="/assets/images/2023-12-07/celpax-1Lf5Adh9SCg-unsplash.jpg" alt="person holding white card near green plant"> </div> <h2 class="archive__item-title no_toc" itemprop="headline"> <a href="/blog/coding-test-review-culture-amp/" rel="permalink">Coding Test Review: Culture Amp </a> </h2> <p class="page__meta"> <span class="page__meta-date"> <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> <time datetime="2023-12-07T15:10:00+11:00">December 7, 2023</time> </span> <span class="page__meta-sep"></span> <span class="page__meta-readtime"> <i class="far fa-fw fa-clock" aria-hidden="true"></i> 20 minute read </span> </p> <p class="archive__item-excerpt" itemprop="description">Did I feel empowered to get the coding tests done for which I am responsible? </p> </article> </div> <div class="grid__item"> <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork"> <div class="archive__item-teaser"> <img src="/assets/images/2023-10-25/dot-matrix-printer.jpg" alt="Epson LX-300+ dot matrix printer with optional colour kit"> </div> <h2 class="archive__item-title no_toc" itemprop="headline"> <a href="/blog/same-page-hid-device/" rel="permalink">Get on the Same Page as your HID Device </a> </h2> <p class="page__meta"> <span class="page__meta-date"> <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> <time datetime="2023-10-25T16:25:00+11:00">October 25, 2023</time> </span> <span class="page__meta-sep"></span> <span class="page__meta-readtime"> <i class="far fa-fw fa-clock" aria-hidden="true"></i> 14 minute read </span> </p> <p class="archive__item-excerpt" itemprop="description">Does communicating with your HID device seem flaky? You may be looking at the wrong (usage) page. </p> </article> </div> <div class="grid__item"> <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork"> <div class="archive__item-teaser"> <img src="/assets/images/2023-04-28/obama-medal.jpg" alt="Obama gives medal to himself meme"> </div> <h2 class="archive__item-title no_toc" itemprop="headline"> <a href="/blog/thanks-past-me/" rel="permalink">Thanks, Past-Me </a> </h2> <p class="page__meta"> <span class="page__meta-date"> <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> <time datetime="2023-04-28T15:30:00+10:00">April 28, 2023</time> </span> <span class="page__meta-sep"></span> <span class="page__meta-readtime"> <i class="far fa-fw fa-clock" aria-hidden="true"></i> 19 minute read </span> <span class="page__meta-sep"></span> <i class="fas fa-microphone" aria-hidden="true"></i> Audio Narration </p> <p class="archive__item-excerpt" itemprop="description">Past-me wrote stuff down that benefited future-me. Present-me needs to keep paying that forward. </p> </article> </div> </div> </div> </div> </div> <div class="search-content"> <div class="search-content__inner-wrap"> <form class="search-content__form" onkeydown="return event.key != 'Enter';"> <label class="sr-only" for="search"> Enter your search term... </label> <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..."> </form> <div id="results" class="results"></div> </div> </div> <div id="footer" class="page__footer"> <footer> <div class="page__footer-follow"> <ul class="social-icons"> <li><strong>Follow:</strong></li> <li> <a href="/privacy"> <i class="fas fa-user-shield"></i> Privacy Policy </a> </li> <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li> </ul> </div> <div class="page__footer-copyright">¬© 2024 Paul Fioravanti. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> </footer> </div> <script src="/assets/js/main.min.js"></script> <script src="/assets/js/lunr/lunr.min.js"></script> <script src="/assets/js/lunr/lunr-store.js"></script> <script src="/assets/js/lunr/lunr-en.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q173829KF7"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-Q173829KF7",{anonymize_ip:!1});</script> <script>var disqus_config=function(){this.page.url="https://www.paulfioravanti.com/blog/flashing-georgi-firmware/",this.page.identifier="/blog/flashing-georgi-firmware"};!function(){var i=document,t=i.createElement("script");t.src="https://paulfioravanti.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(i.head||i.body).appendChild(t)}();</script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript> </body> </html>