<!doctype html> <html lang="en" class="no-js"> <head> <meta charset="utf-8"> <title>Internationalisation with Phoenix Live Layouts | Floor and Varnish</title> <meta name="description" content="Phoenix layouts are now live-powered, giving LiveViews more flexibility and control over a template’s surrounding content."> <meta name="author" content="Paul Fioravanti"> <meta property="og:type" content="article"> <meta property="og:locale" content="en_US"> <meta property="og:site_name" content="Floor and Varnish"> <meta property="og:title" content="Internationalisation with Phoenix Live Layouts"> <meta property="og:url" content="https://paulfioravanti.com/blog/2020/02/03/internationalisation-with-phoenix-live-layouts/"> <meta property="og:description" content="Phoenix layouts are now live-powered, giving LiveViews more flexibility and control over a template’s surrounding content."> <meta property="og:image" content="https://paulfioravanti.com/assets/images/2020-02-03/kyle-glenn-nXt5HtLmlgE-unsplash.jpg"> <meta name="twitter:site" content="@paulfioravanti"> <meta name="twitter:title" content="Internationalisation with Phoenix Live Layouts"> <meta name="twitter:description" content="Phoenix layouts are now live-powered, giving LiveViews more flexibility and control over a template’s surrounding content."> <meta name="twitter:url" content="https://paulfioravanti.com/blog/2020/02/03/internationalisation-with-phoenix-live-layouts/"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:image" content="https://paulfioravanti.com/assets/images/2020-02-03/kyle-glenn-nXt5HtLmlgE-unsplash.jpg"> <meta name="twitter:creator" content="@paulfioravanti"> <meta property="article:published_time" content="2020-02-03T17:00:00+11:00"> <meta property="article:modified_time" content="2020-02-03T17:00:00+11:00"> <link rel="canonical" href="https://paulfioravanti.com/blog/2020/02/03/internationalisation-with-phoenix-live-layouts/"> <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Paul Fioravanti",
      "url": "https://paulfioravanti.com/"
    
  }
</script> <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Floor and Varnish Feed"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <script>document.documentElement.className=document.documentElement.className.replace(/\bno-js\b/g,"")+" js ";</script> <link rel="stylesheet" href="/assets/css/main.css"> <!--[if IE]><style>.greedy-nav .site-title{padding-right:3em}.greedy-nav button{position:absolute;top:0;right:0;height:100%}</style><![endif]--> </head> <body class="layout--single wide"> <nav class="skip-links"> <h2 class="screen-reader-text">Skip links</h2> <ul> <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li> <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li> <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li> </ul> </nav> <!--[if lt IE 9]><div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]--> <div class="masthead"> <div class="masthead__inner-wrap"> <div class="masthead__menu"> <nav id="site-nav" class="greedy-nav"> <a class="site-title" href="/"> Floor and Varnish </a> <ul class="visible-links"></ul> <button class="greedy-nav__toggle hidden" type="button"> <span class="visually-hidden">Toggle menu</span> <div class="navicon"></div> </button> <ul class="hidden-links hidden"></ul> </nav> </div> </div> </div> <div class="initial-content"> <div class="page__hero--overlay" style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/assets/images/2020-02-03/kyle-glenn-nXt5HtLmlgE-unsplash.jpg');"> <div class="wrapper"> <h1 id="page-title" class="page__title" itemprop="headline"> Internationalisation with Phoenix Live Layouts </h1> <p class="page__lead">Phoenix layouts are now live-powered, giving LiveViews more flexibility and control over a template’s surrounding content. </p> <p class="page__meta"> <i class="fa fa-calendar-alt" aria-hidden="true"></i> <time datetime="2020-02-03T17:00:00+11:00"> February 03, 2020 </time> &nbsp; <i class="far fa-clock" aria-hidden="true"></i> 9 minute read </p> <a href="https://elixirweekly.net/issues/187" style="text-decoration: none;"> <img src="https://img.shields.io/badge/Elixir%20Weekly-%23187-blueviolet.svg" alt="Elixir Weekly #187"/> </a> </div> <span class="page__hero-caption">Photo by <a href="https://unsplash.com/@kylejglenn?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Kyle Glenn</a> on <a href="https://unsplash.com/s/photos/international?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a> </span> </div> <div id="main" role="main"> <div class="sidebar sticky"> <div itemscope itemtype="https://schema.org/Person"> <div class="author__avatar"> <a href="/"> <img src="https://s.gravatar.com/avatar/abda861707b1e78e0fce47ced55f84ee" alt="Paul Fioravanti" itemprop="image"> </a> </div> <div class="author__content"> <a href=""><h3 class="author__name" itemprop="name">Paul Fioravanti</h3></a> <div class="author__bio" itemprop="description"> <p>Coder, linguist, mechanical keyboard enthusiast.</p> </div> </div> <div class="author__urls-wrapper"> <button class="btn btn--inverse">Follow</button> <ul class="author__urls social-icons"> <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place"> <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Sydney, Australia</span> </li> <li> <a href="https://paulfioravanti.com" itemprop="url"> <i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span> </a> </li> <li> <a href="mailto:paul.fioravanti@gmail.com"> <meta itemprop="email" content="paul.fioravanti@gmail.com"/> <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span> </a> </li> <li> <a href="https://twitter.com/paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span> </a> </li> <li> <a href="https://www.linkedin.com/in/paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span> </a> </li> <li> <a href="https://github.com/paulfioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span> </a> </li> <li> <a href="https://stackoverflow.com/users/567863/paul-fioravanti" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">Stack Overflow</span> </a> </li> </ul> </div> </div> </div> <article class="page" itemscope itemtype="https://schema.org/CreativeWork"> <meta itemprop="headline" content="Internationalisation with Phoenix Live Layouts"> <meta itemprop="description" content="Phoenix layouts are now live-powered, giving LiveViews more flexibility and control over a template’s surrounding content."> <meta itemprop="datePublished" content="2020-02-03T17:00:00+11:00"> <meta itemprop="dateModified" content="2020-02-03T17:00:00+11:00"> <div class="page__inner-wrap"> <section class="page__content" itemprop="text"> <p>This blog post is the third in a series on the creation of a small <a href="https://en.wikipedia.org/wiki/Internationalization_and_localization#Naming">I18n</a> application using <a href="https://github.com/phoenixframework/phoenix_live_view">Phoenix LiveView</a>, which updates page content based on the language chosen from a dropdown menu:</p> <ol> <li><em><a href="https://paulfioravanti.com/blog/2019/11/03/internationalisation-with-phoenix-liveview/">Internationalisation with Phoenix LiveView</a></em></li> <li><em><a href="http://paulfioravanti.com/blog/2020/01/27/internationalisation-with-phoenix-live-components/">Internationalisation with Phoenix LiveComponents</a></em></li> <li><em>Internationalisation with Phoenix Live Layouts</em></li> </ol> <p style="text-align: center;"><img src="/assets/images/2020-02-03/i18n-application.gif" alt="I18n Application" title="Internationalisation Application"/></p> <p><a href="https://github.com/phoenixframework/phoenix_live_view/blob/master/CHANGELOG.md#050-2020-01-15">LiveView version 0.5.0</a> introduced <a href="https://hexdocs.pm/phoenix_live_view/Phoenix.LiveView.html#module-live-layouts">Live Layouts</a>, a mechanism that allows LiveViews to move view-specific layout code into separate sub-layout files. This enables an individual LiveView’s template to nest itself within content that can dynamically update.</p> <p>We will continue developing the application where we left off from the end of <em><a href="http://paulfioravanti.com/blog/2020/01/27/internationalisation-with-phoenix-live-components/">Internationalisation with Phoenix LiveComponents</a></em>, which is its state on the <a href="https://github.com/paulfioravanti/phx_i18n_example/tree/08-live-stateful-0-6"><code class="language-plaintext highlighter-rouge">08-live-stateful-0-6</code> branch</a> of the <a href="https://github.com/paulfioravanti/phx_i18n_example">phx_i18n_example</a> Github repository. That branch does not use Live Layouts, so we will see what the issues are with <em>not</em> using them, and then proceed to implement them.</p> <p>If you do not have the repository already, just run these commands and it shall find its way to you:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:paulfioravanti/phx_i18n_example.git
<span class="nb">cd </span>phx_i18n_example
git checkout 08-live-stateful-0-6
</code></pre></div></div> <blockquote> <p>The software versions used for this version of the application are the following:</p> <ul> <li>Elixir: 1.10.0</li> <li>Erlang: 22.2.1</li> <li>Phoenix: 1.4.12</li> <li>Gettext: 0.17.4</li> <li>LiveView: 0.6.0</li> <li>Node: 13.6.0</li> <li>Tachyons: 4.11.1</li> </ul> </blockquote> <h2 id="current-state-of-play">Current State of Play</h2> <p>There are three LiveViews in the application, each operating independently, containing their own <a href="https://hexdocs.pm/phoenix_live_view/Phoenix.LiveComponent.html">LiveComponent</a>, and communicating with each other by <a href="https://github.com/phoenixframework/phoenix_pubsub">PubSub</a> where needed:</p> <p><img src="/assets/images/2020-02-03/live-view-summary.jpg" alt="LiveView Summary" title="LiveView Summary"/></p> <p><code class="language-plaintext highlighter-rouge">LanguageDropdownLiveView</code> and <code class="language-plaintext highlighter-rouge">TitleLiveView</code> are live rendered from the (static) layout:</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/templates/layout/app.html.eex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">!DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span> <span class="n">lang</span><span class="o">=</span><span class="s2">"en"</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">!</span><span class="o">--</span> <span class="o">...</span> <span class="o">--&gt;</span>
    <span class="o">&lt;%=</span> <span class="n">live_render</span> <span class="nv">@conn</span><span class="p">,</span>
                    <span class="no">TitleLiveView</span><span class="p">,</span>
                    <span class="ss">session:</span> <span class="p">%{</span><span class="s2">"locale"</span> <span class="o">=&gt;</span> <span class="nv">@locale</span><span class="p">,</span> <span class="s2">"user_id"</span> <span class="o">=&gt;</span> <span class="nv">@user_id</span><span class="p">}</span> <span class="p">%</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">!</span><span class="o">--</span> <span class="o">...</span> <span class="o">--&gt;</span>
  <span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">body</span> <span class="n">class</span><span class="o">=</span><span class="s2">"&lt;%= body() %&gt;"</span><span class="o">&gt;</span>
    <span class="o">&lt;%=</span> <span class="n">live_render</span> <span class="nv">@conn</span><span class="p">,</span>
                    <span class="no">LanguageDropdownLiveView</span><span class="p">,</span>
                    <span class="ss">session:</span> <span class="p">%{</span><span class="s2">"locale"</span> <span class="o">=&gt;</span> <span class="nv">@locale</span><span class="p">,</span> <span class="s2">"user_id"</span> <span class="o">=&gt;</span> <span class="nv">@user_id</span><span class="p">}</span> <span class="p">%</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">main</span> <span class="n">role</span><span class="o">=</span><span class="s2">"main"</span><span class="o">&gt;</span>
      <span class="o">&lt;%=</span> <span class="n">render</span> <span class="nv">@view_module</span><span class="p">,</span> <span class="nv">@view_template</span><span class="p">,</span> <span class="n">assigns</span> <span class="p">%</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">main</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</code></pre></div></div> <h2 id="the-problem">The Problem</h2> <p>For the application in its current form, this presents no issue. However, what if we wanted to add another routed LiveView (a LiveView used from <code class="language-plaintext highlighter-rouge">router.ex</code>) to the application to complement <code class="language-plaintext highlighter-rouge">PageLiveView</code>? What if we wanted to have this new LiveView set its own page title, or what if its content did not need to be internationalised, and hence we would not need the language dropdown menu to display?</p> <p>The <code class="language-plaintext highlighter-rouge">app.html.eex</code> file is the main layout template within which all other template content is embedded, which means that any new LiveView would not have any control over the content that surrounds its template code:</p> <ul> <li>its title would be set according to whatever <code class="language-plaintext highlighter-rouge">TitleLiveView</code> renders, rather than being able to provide its own page title logic</li> <li><code class="language-plaintext highlighter-rouge">LanguageDropdownLiveView</code> will always be rendered (meaning also that the new LiveView would have to unnecessarily implement handlers for the <code class="language-plaintext highlighter-rouge">"change-locale"</code> events that the dropdown menu emits)</li> </ul> <p>So, let’s set about giving our routed LiveView, in this case <code class="language-plaintext highlighter-rouge">PageLiveView</code>, more control over its surrounding content, starting with the page title.</p> <h2 id="liveview-controlled-page-title-updates">LiveView-Controlled Page Title Updates</h2> <p>With LiveView 0.5.0, <a href="https://hexdocs.pm/phoenix_live_view/Phoenix.LiveView.html#module-updating-the-html-document-title">updating the HTML document title</a> of a page becomes possible through <em>specific use</em> of an assigns variable called <code class="language-plaintext highlighter-rouge">@page_title</code>. Normally, the content of <code class="language-plaintext highlighter-rouge">app.html.eex</code>, or any non-<code class="language-plaintext highlighter-rouge">.leex</code> template, cannot be dynamically changed. But, Phoenix LiveView special-cases the page title, enabling a LiveView module to set the page title in <a href="https://hexdocs.pm/phoenix_live_view/Phoenix.LiveView.html#c:mount/3"><code class="language-plaintext highlighter-rouge">Phoenix.LiveView.mount/3</code></a>, and update it in any event handling callback functions.</p> <p>So, in the layout, let’s switch out <code class="language-plaintext highlighter-rouge">TitleLiveView</code> for <code class="language-plaintext highlighter-rouge">@page_title</code>:</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/templates/layout/app.html.eex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">!DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span> <span class="n">lang</span><span class="o">=</span><span class="s2">"en"</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">!</span><span class="o">--</span> <span class="o">...</span> <span class="o">--&gt;</span>
     <span class="o">&lt;</span><span class="n">title</span><span class="err">&gt;</span><span class="o">&lt;%=</span> <span class="nv">@page_title</span> <span class="p">%</span><span class="err">&gt;</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">!</span><span class="o">--</span> <span class="o">...</span> <span class="o">--&gt;</span>
  <span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">!</span><span class="o">--</span> <span class="o">...</span> <span class="o">--&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">!DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Now, in <code class="language-plaintext highlighter-rouge">PageLiveView</code>, let’s initialise the <code class="language-plaintext highlighter-rouge">page_title</code> assigns in <code class="language-plaintext highlighter-rouge">mount/3</code>, and update its value when the locale changes (ie we receive an external <code class="language-plaintext highlighter-rouge">"change-locale"</code> PubSub message):</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/live/views/page_live_view.ex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">PageLiveView</span> <span class="k">do</span>
  <span class="c1"># ...</span>
  <span class="kn">require</span> <span class="no">Gettext</span>
  <span class="kn">require</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">Gettext</span>

  <span class="nv">@title</span> <span class="s2">"Multilingualisation in Phoenix"</span>
  <span class="nv">@locale_changes</span> <span class="s2">"locale-changes:"</span>

  <span class="k">def</span> <span class="n">mount</span><span class="p">(</span>
        <span class="p">%{}</span> <span class="o">=</span> <span class="n">_params</span><span class="p">,</span>
        <span class="p">%{</span><span class="s2">"locale"</span> <span class="o">=&gt;</span> <span class="n">locale</span><span class="p">,</span> <span class="s2">"user_id"</span> <span class="o">=&gt;</span> <span class="n">user_id</span><span class="p">},</span>
        <span class="n">socket</span>
      <span class="p">)</span> <span class="k">do</span>
    <span class="no">Endpoint</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="nv">@locale_changes</span> <span class="o">&lt;&gt;</span> <span class="n">user_id</span><span class="p">)</span>

    <span class="n">socket</span> <span class="o">=</span>
      <span class="n">assign</span><span class="p">(</span>
        <span class="n">socket</span><span class="p">,</span>
        <span class="ss">locale:</span> <span class="n">locale</span><span class="p">,</span>
        <span class="ss">user_id:</span> <span class="n">user_id</span><span class="p">,</span>
        <span class="ss">page_title:</span> <span class="n">page_title</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span>
      <span class="p">)</span>

    <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">socket</span><span class="p">}</span>
  <span class="k">end</span>

  <span class="c1"># ...</span>

  <span class="k">def</span> <span class="n">handle_info</span><span class="p">(</span>
        <span class="p">%{</span><span class="ss">event:</span> <span class="s2">"change-locale"</span><span class="p">,</span> <span class="ss">payload:</span> <span class="p">%{</span><span class="ss">locale:</span> <span class="n">locale</span><span class="p">}},</span>
        <span class="n">socket</span>
      <span class="p">)</span> <span class="k">do</span>
    <span class="n">send_update</span><span class="p">(</span><span class="no">PageLiveComponent</span><span class="p">,</span> <span class="ss">id:</span> <span class="ss">:page</span><span class="p">,</span> <span class="ss">locale:</span> <span class="n">locale</span><span class="p">)</span>
    <span class="n">socket</span> <span class="o">=</span> <span class="n">assign</span><span class="p">(</span><span class="n">socket</span><span class="p">,</span> <span class="ss">locale:</span> <span class="n">locale</span><span class="p">,</span> <span class="ss">page_title:</span> <span class="n">page_title</span><span class="p">(</span><span class="n">locale</span><span class="p">))</span>
    <span class="p">{</span><span class="ss">:noreply</span><span class="p">,</span> <span class="n">socket</span><span class="p">}</span>
  <span class="k">end</span>

  <span class="k">defp</span> <span class="n">page_title</span><span class="p">(</span><span class="n">locale</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="no">Gettext</span><span class="o">.</span><span class="n">with_locale</span><span class="p">(</span><span class="n">locale</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">title</span><span class="o">/</span><span class="mi">0</span><span class="p">)</span>
  <span class="k">defp</span> <span class="n">title</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">Gettext</span><span class="o">.</span><span class="n">gettext</span><span class="p">(</span><span class="nv">@title</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div> <p>You should now see that the application continues to work as expected.</p> <p>Just by virtue of setting and updating the <code class="language-plaintext highlighter-rouge">page_title</code> assigns value, Phoenix does all the heavy lifting of dynamically updating the <code class="language-plaintext highlighter-rouge">@page_title</code> module attribute. <code class="language-plaintext highlighter-rouge">PageLiveView</code> now has complete control over the page title when its template is rendered, which means the <code class="language-plaintext highlighter-rouge">TitleLiveView</code> and <code class="language-plaintext highlighter-rouge">TitleLiveComponent</code> modules have become completely obsolete. So, we can reduce our maintenance burden by removing them entirely. Hurray!</p> <h2 id="live-layouts">Live Layouts</h2> <p>Let’s now move our focus over to enabling LiveViews to choose whether they want to display a language selection dropdown menu or not, by extracting code for it into a separate layout.</p> <p>We will start by removing the call to live render the <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveView</code> from the main layout’s <code class="language-plaintext highlighter-rouge">&lt;body&gt;</code> tag:</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/templates/layout/app.html.eex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">!DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span> <span class="n">lang</span><span class="o">=</span><span class="s2">"en"</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">!</span><span class="o">--</span> <span class="o">...</span> <span class="o">--&gt;</span>
  <span class="o">&lt;</span><span class="n">body</span> <span class="n">class</span><span class="o">=</span><span class="s2">"&lt;%= body() %&gt;"</span><span class="o">&gt;</span>
    <span class="o">&lt;%=</span> <span class="n">render</span> <span class="nv">@view_module</span><span class="p">,</span> <span class="nv">@view_template</span><span class="p">,</span> <span class="n">assigns</span> <span class="p">%</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</code></pre></div></div> <p>That code will now go directly inside a new page Live Layout file (note the <code class="language-plaintext highlighter-rouge">.leex</code> filename):</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/templates/layout/page.html.leex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%=</span> <span class="n">live_render</span> <span class="nv">@socket</span><span class="p">,</span>
                <span class="no">LanguageDropdownLiveView</span><span class="p">,</span>
                <span class="ss">id:</span> <span class="ss">:language_dropdown</span><span class="p">,</span>
                <span class="ss">session:</span> <span class="p">%{</span><span class="s2">"locale"</span> <span class="o">=&gt;</span> <span class="nv">@locale</span><span class="p">,</span> <span class="s2">"user_id"</span> <span class="o">=&gt;</span> <span class="nv">@user_id</span><span class="p">}</span> <span class="p">%</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">main</span> <span class="n">role</span><span class="o">=</span><span class="s2">"main"</span><span class="o">&gt;</span>
  <span class="o">&lt;%=</span> <span class="nv">@live_view_module</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">assigns</span><span class="p">)</span> <span class="p">%</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">main</span><span class="o">&gt;</span>
</code></pre></div></div> <p>In this case, the <code class="language-plaintext highlighter-rouge">@live_view_module</code> attribute refers to the <code class="language-plaintext highlighter-rouge">PageLiveView</code> module.</p> <p>Now, we need to specify that <code class="language-plaintext highlighter-rouge">PageLiveView</code> will be using this layout to wrap its template content:</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/live/views/page_live_view.ex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">PageLiveView</span> <span class="k">do</span>
  <span class="n">alias</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="p">{</span><span class="no">Endpoint</span><span class="p">,</span> <span class="no">LayoutView</span><span class="p">,</span> <span class="no">PageLiveComponent</span><span class="p">}</span>
  <span class="kn">use</span> <span class="no">Phoenix</span><span class="o">.</span><span class="no">LiveView</span><span class="p">,</span> <span class="ss">layout:</span> <span class="p">{</span><span class="no">LayoutView</span><span class="p">,</span> <span class="s2">"page.html"</span><span class="p">}</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div></div> <p>Note that the <code class="language-plaintext highlighter-rouge">LayoutView</code> is doing double-duty here as the view file for <em>both</em> <code class="language-plaintext highlighter-rouge">app.html.eex</code> <em>and</em> <code class="language-plaintext highlighter-rouge">page.html.leex</code>. If we were to extract the template code inline with the view code, it would look like this (also note the differences in sigils used; <code class="language-plaintext highlighter-rouge">~E</code> for standard embedded Elixir templates vs <code class="language-plaintext highlighter-rouge">~L</code> for LiveView templates):</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/views/layout_view.ex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">LayoutView</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">PhxI18nExampleWeb</span><span class="p">,</span> <span class="ss">:view</span>
  <span class="n">alias</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="p">{</span><span class="no">LanguageDropdownLiveView</span><span class="p">,</span> <span class="no">LayoutStyle</span><span class="p">}</span>

  <span class="k">defdelegate</span> <span class="n">body</span><span class="p">,</span> <span class="ss">to:</span> <span class="no">LayoutStyle</span>

  <span class="k">def</span> <span class="n">render</span><span class="p">(</span><span class="s2">"app.html"</span><span class="p">,</span> <span class="n">assigns</span><span class="p">)</span> <span class="k">do</span>
    <span class="sx">~E""</span><span class="s2">"
    &lt;!DOCTYPE html&gt;
    &lt;html lang="</span><span class="n">en</span><span class="s2">"&gt;
      &lt;head&gt;
        &lt;meta charset="</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="s2">"/&gt;
        &lt;meta http-equiv="</span><span class="no">X</span><span class="o">-</span><span class="no">UA</span><span class="o">-</span><span class="no">Compatible</span><span class="s2">" content="</span><span class="no">IE</span><span class="o">=</span><span class="n">edge</span><span class="s2">"/&gt;
        &lt;meta name="</span><span class="n">viewport</span><span class="s2">" content="</span><span class="n">width</span><span class="o">=</span><span class="n">device</span><span class="o">-</span><span class="n">width</span><span class="p">,</span> <span class="n">initial</span><span class="o">-</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="s2">"/&gt;
        &lt;%= csrf_meta_tag() %&gt;
        &lt;title&gt;&lt;%= @page_title %&gt;&lt;/title&gt;
        &lt;link rel="</span><span class="n">stylesheet</span><span class="s2">"
              href="</span><span class="o">&lt;%=</span> <span class="no">Routes</span><span class="o">.</span><span class="n">static_path</span><span class="p">(</span><span class="nv">@conn</span><span class="p">,</span> <span class="s2">"/css/app.css"</span><span class="p">)</span> <span class="p">%</span><span class="o">&gt;</span><span class="s2">"/&gt;
        &lt;script type="</span><span class="n">text</span><span class="o">/</span><span class="n">javascript</span><span class="s2">"
                src="</span><span class="o">&lt;%=</span> <span class="no">Routes</span><span class="o">.</span><span class="n">static_path</span><span class="p">(</span><span class="nv">@conn</span><span class="p">,</span> <span class="s2">"/js/app.js"</span><span class="p">)</span> <span class="p">%</span><span class="o">&gt;</span><span class="s2">"&gt;
        &lt;/script&gt;
      &lt;/head&gt;
      &lt;body class="</span><span class="o">&lt;%=</span> <span class="n">body</span><span class="p">()</span> <span class="p">%</span><span class="o">&gt;</span><span class="s2">"&gt;
        &lt;%= render @view_module, @view_template, assigns %&gt;
      &lt;/body&gt;
    &lt;/html&gt;
    """</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">render</span><span class="p">(</span><span class="s2">"page.html"</span><span class="p">,</span> <span class="n">assigns</span><span class="p">)</span> <span class="k">do</span>
    <span class="sx">~L""</span><span class="s2">"
    &lt;%= live_render @socket,
                    LanguageDropdownLiveView,
                    id: :language_dropdown,
                    session: %{"</span><span class="n">locale</span><span class="s2">" =&gt; @locale, "</span><span class="n">user_id</span><span class="s2">" =&gt; @user_id} %&gt;
    &lt;main role="</span><span class="n">main</span><span class="s2">"&gt;
      &lt;%= @live_view_module.render(assigns) %&gt;
    &lt;/main&gt;
    """</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div> <p>The layout code extraction is now complete, and the application works as expected! Or, at least I thought it did, until I tried out the specific use case of opening the language dropdown menu, and then clicking the text on the page, which closes it:</p> <p><img src="/assets/images/2020-02-03/live-layout-issue.gif" alt="Live Layout Issue" title="Live Layout Issue"/></p> <p>Looks like there is a glitch in the LiveView Matrix… Why is the open language dropdown menu disappearing momentarily before re-appearing closed? Ultimately, all we did was cut code from one file, and paste it in another…right?</p> <p>Although I’m not entirely sure of the specifics, it looks like perhaps the communication processes via PubSub between <code class="language-plaintext highlighter-rouge">PageLiveView</code> and <code class="language-plaintext highlighter-rouge">DropdownLanguageLiveView</code> are clobbering each other, and thus a re-think of how these two LiveViews and their LiveComponents talk to each other is in order, as well as deciding whether all these LiveView modules are even needed at all.</p> <h2 id="too-many-liveviews">Too Many LiveViews?</h2> <p>Each of the LiveViews we had in the application at the beginning of this blog post, <code class="language-plaintext highlighter-rouge">PageLiveView</code>, <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveView</code>, and <code class="language-plaintext highlighter-rouge">TitleLiveView</code>, were like isolated islands, functionality-wise.</p> <p><img src="/assets/images/2020-02-03/live-view-summary.jpg" alt="LiveView Summary" title="LiveView Summary"/></p> <p>There was no coupling between any of them; naturally, there was coupling between parent LiveViews and their child LiveComponents, but not between the LiveViews themselves.</p> <p>With the introduction of Live Layouts, this has changed: now, <code class="language-plaintext highlighter-rouge">PageLiveView</code>, as well as being the parent of its own <code class="language-plaintext highlighter-rouge">PageLiveComponent</code>, is also, via the Live Layout, the parent of <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveView</code>, which renders <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveComponent</code>.</p> <p><img src="/assets/images/2020-02-03/live-view-component-summary.jpg" alt="LiveView Component Summary" title="LiveView Component Summary"/></p> <p>With <code class="language-plaintext highlighter-rouge">TitleLiveView</code> gone, the only place that <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveComponent</code> needs to notify about locale changes is the <code class="language-plaintext highlighter-rouge">PageLiveView</code>, its “grandparent”. Similarly, <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveView</code> would only seem to exist to let its child, <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveComponent</code>, know about any <code class="language-plaintext highlighter-rouge">"hide-dropdown"</code> messages that it receives.</p> <p>Given that the <code class="language-plaintext highlighter-rouge">"hide-dropdown"</code> messages come from <code class="language-plaintext highlighter-rouge">PageLiveComponent</code>, wouldn’t it be easier, and maybe less message-clobbery, to:</p> <ul> <li>get rid of the <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveView</code> middleman</li> <li>let <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveComponent</code> be <code class="language-plaintext highlighter-rouge">PageLiveView</code>’s child, rather than grandchild</li> <li>have <code class="language-plaintext highlighter-rouge">PageLiveComponent</code> and <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveComponent</code> talk to each other as siblings through <code class="language-plaintext highlighter-rouge">PageLiveView</code>?</li> </ul> <p>Let’s find out!</p> <h2 id="family-tree-engineering">Family Tree Engineering</h2> <p>Okay, first thing’s first, <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveView</code> is now <em>gone</em>. What do we need to do to get this working again? Let’s start with <code class="language-plaintext highlighter-rouge">PageLiveView</code>’s Live Layout, which now needs to directly render <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveComponent</code>:</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/views/layout_view.ex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">LayoutView</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">PhxI18nExampleWeb</span><span class="p">,</span> <span class="ss">:view</span>
  <span class="n">alias</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="p">{</span><span class="no">LanguageDropdownLiveComponent</span><span class="p">,</span> <span class="no">LayoutStyle</span><span class="p">}</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div></div> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/templates/layout/page.html.leex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%=</span> <span class="n">live_component</span> <span class="nv">@socket</span><span class="p">,</span>
                   <span class="no">LanguageDropdownLiveComponent</span><span class="p">,</span>
                   <span class="ss">id:</span> <span class="ss">:language_dropdown</span><span class="p">,</span>
                   <span class="ss">locale:</span> <span class="nv">@locale</span><span class="p">,</span>
                   <span class="ss">user_id:</span> <span class="nv">@user_id</span> <span class="p">%</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">main</span> <span class="n">role</span><span class="o">=</span><span class="s2">"main"</span><span class="o">&gt;</span>
  <span class="o">&lt;%=</span> <span class="nv">@live_view_module</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">assigns</span><span class="p">)</span> <span class="p">%</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">main</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Now, in the <code class="language-plaintext highlighter-rouge">LanguageDropdownLiveComponent</code>, whenever we get a local <code class="language-plaintext highlighter-rouge">"locale-changed"</code> event, rather than blast out a PubSub message, we instead want to send that message to the now-direct parent, <code class="language-plaintext highlighter-rouge">PageLiveView</code>:</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/live/components/language_dropdown_live_component.ex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">LanguageDropdownLiveComponent</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">Phoenix</span><span class="o">.</span><span class="no">LiveComponent</span>
  <span class="n">alias</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">LanguageDropdownView</span>

  <span class="nv">@locales</span> <span class="no">Gettext</span><span class="o">.</span><span class="n">known_locales</span><span class="p">(</span><span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">Gettext</span><span class="p">)</span>

  <span class="c1"># ...</span>
  <span class="k">def</span> <span class="n">handle_event</span><span class="p">(</span><span class="s2">"locale-changed"</span><span class="p">,</span> <span class="p">%{</span><span class="s2">"locale"</span> <span class="o">=&gt;</span> <span class="n">locale</span><span class="p">},</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">send</span><span class="p">(</span><span class="n">self</span><span class="p">(),</span> <span class="p">{</span><span class="ss">:change_locale</span><span class="p">,</span> <span class="n">locale</span><span class="p">})</span>

    <span class="n">state</span> <span class="o">=</span> <span class="n">update_locale_changed_state</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">assigns</span><span class="p">,</span> <span class="n">locale</span><span class="p">)</span>
    <span class="n">socket</span> <span class="o">=</span> <span class="n">assign</span><span class="p">(</span><span class="n">socket</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="p">{</span><span class="ss">:noreply</span><span class="p">,</span> <span class="n">socket</span><span class="p">}</span>
  <span class="k">end</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div></div> <p>Note here that because the LiveComponent and the LiveView run in the same process, sending a message to <code class="language-plaintext highlighter-rouge">self()</code> <a href="https://hexdocs.pm/phoenix_live_view/Phoenix.LiveComponent.html#module-liveview-as-the-source-of-truth">sends the message from the component to the parent LiveView</a>.</p> <p>While we are purging PubSub message passing, let’s go next to <code class="language-plaintext highlighter-rouge">PageLiveView</code>’s other child, <code class="language-plaintext highlighter-rouge">PageLiveComponent</code>, and perform a similar refactor for when it receives <code class="language-plaintext highlighter-rouge">"hide-dropdown"</code> messages:</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/live/components/page_live_component.ex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">PageLiveComponent</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">Phoenix</span><span class="o">.</span><span class="no">LiveComponent</span>
  <span class="n">alias</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">PageView</span>

  <span class="c1"># ...</span>
  <span class="k">def</span> <span class="n">handle_event</span><span class="p">(</span><span class="s2">"hide-dropdown"</span><span class="p">,</span> <span class="n">_value</span><span class="p">,</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">send</span><span class="p">(</span><span class="n">self</span><span class="p">(),</span> <span class="ss">:hide_dropdown</span><span class="p">)</span>

    <span class="p">{</span><span class="ss">:noreply</span><span class="p">,</span> <span class="n">socket</span><span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div> <p>All message-passing from child LiveComponents to parent LiveViews is now being done without PubSub. Finally, we need to make changes in the parent <code class="language-plaintext highlighter-rouge">PageLiveView</code> to swap any PubSub-related subscription and message-handling code for taking messages directly from children:</p> <p><strong><code class="language-plaintext highlighter-rouge">lib/phx_i18n_example_web/live/views/page_live_view.ex</code></strong></p> <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="no">PageLiveView</span> <span class="k">do</span>
  <span class="n">alias</span> <span class="no">PhxI18nExampleWeb</span><span class="o">.</span><span class="p">{</span>
    <span class="no">LanguageDropdownLiveComponent</span><span class="p">,</span>
    <span class="no">LayoutView</span><span class="p">,</span>
    <span class="no">PageLiveComponent</span>
  <span class="p">}</span>

  <span class="c1"># ...</span>
  <span class="k">def</span> <span class="n">mount</span><span class="p">(</span>
        <span class="p">%{}</span> <span class="o">=</span> <span class="n">_params</span><span class="p">,</span>
        <span class="p">%{</span><span class="s2">"locale"</span> <span class="o">=&gt;</span> <span class="n">locale</span><span class="p">,</span> <span class="s2">"user_id"</span> <span class="o">=&gt;</span> <span class="n">user_id</span><span class="p">},</span>
        <span class="n">socket</span>
      <span class="p">)</span> <span class="k">do</span>
    <span class="n">socket</span> <span class="o">=</span>
      <span class="n">assign</span><span class="p">(</span>
        <span class="n">socket</span><span class="p">,</span>
        <span class="ss">locale:</span> <span class="n">locale</span><span class="p">,</span>
        <span class="ss">user_id:</span> <span class="n">user_id</span><span class="p">,</span>
        <span class="ss">page_title:</span> <span class="n">page_title</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span>
      <span class="p">)</span>

    <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">socket</span><span class="p">}</span>
  <span class="k">end</span>

  <span class="c1"># ...</span>

  <span class="k">def</span> <span class="n">handle_info</span><span class="p">(</span><span class="ss">:hide_dropdown</span><span class="p">,</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">send_update</span><span class="p">(</span>
      <span class="no">LanguageDropdownLiveComponent</span><span class="p">,</span>
      <span class="ss">id:</span> <span class="ss">:language_dropdown</span><span class="p">,</span>
      <span class="ss">show_available_locales:</span> <span class="no">false</span>
    <span class="p">)</span>

    <span class="p">{</span><span class="ss">:noreply</span><span class="p">,</span> <span class="n">socket</span><span class="p">}</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">handle_info</span><span class="p">({</span><span class="ss">:change_locale</span><span class="p">,</span> <span class="n">locale</span><span class="p">},</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">send_update</span><span class="p">(</span><span class="no">PageLiveComponent</span><span class="p">,</span> <span class="ss">id:</span> <span class="ss">:page</span><span class="p">,</span> <span class="ss">locale:</span> <span class="n">locale</span><span class="p">)</span>
    <span class="n">socket</span> <span class="o">=</span> <span class="n">assign</span><span class="p">(</span><span class="n">socket</span><span class="p">,</span> <span class="ss">locale:</span> <span class="n">locale</span><span class="p">,</span> <span class="ss">page_title:</span> <span class="n">page_title</span><span class="p">(</span><span class="n">locale</span><span class="p">))</span>
    <span class="p">{</span><span class="ss">:noreply</span><span class="p">,</span> <span class="n">socket</span><span class="p">}</span>
  <span class="k">end</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div></div> <p>Notice that in the <code class="language-plaintext highlighter-rouge">handle_info/2</code> functions, the parameters are now atoms or tuples, and not the maps (eg <code class="language-plaintext highlighter-rouge">%{event: "change-locale", payload: %{locale: locale}}</code>) that we had before.</p> <p>The application should now be flicker-less when hiding an open dropdown by clicking the page.</p> <p>You can find the code for this iteration of the application in this post’s <a href="https://github.com/paulfioravanti/phx_i18n_example">companion Github repo</a> on the <a href="https://github.com/paulfioravanti/phx_i18n_example/tree/09-live-layout"><code class="language-plaintext highlighter-rouge">09-live-layout</code> branch</a>. The branch is also deployed <a href="https://phx-i18n-09-live-layout.herokuapp.com/">here</a> in its own environment.</p> <h2 id="wrapping-up">Wrapping Up</h2> <p>The use of Live Layouts, even in this small application, has affected its architecture greatly. It has been interesting, at least for myself as the author, to have seen the codebase expand initially with lots of LiveViews and LiveComponents, and now contract back as we purge half of them away.</p> <p>Deleted code is the easiest kind to maintain, though, so I do not mourn for it. Rather, I think it’s great that Live Layouts have enabled more flexibility in architecting LiveView functionality, and I look forward to using them more moving forward!</p> </section> <footer class="page__meta"> <p class="page__taxonomy"> <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong> <span itemprop="keywords"> <a href="/tags/elixir" class="page__taxonomy-item" rel="tag">elixir</a><span class="sep">, </span> <a href="/tags/i18n" class="page__taxonomy-item" rel="tag">i18n</a><span class="sep">, </span> <a href="/tags/live-components" class="page__taxonomy-item" rel="tag">live-components</a><span class="sep">, </span> <a href="/tags/live-layout" class="page__taxonomy-item" rel="tag">live-layout</a><span class="sep">, </span> <a href="/tags/liveview" class="page__taxonomy-item" rel="tag">liveview</a><span class="sep">, </span> <a href="/tags/phoenix" class="page__taxonomy-item" rel="tag">phoenix</a> </span> </p> <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-02-03">February 3, 2020</time></p> </footer> <section class="page__share"> <a href="https://twitter.com/intent/tweet?via=paulfioravanti&text=Internationalisation+with+Phoenix+Live+Layouts%20https%3A%2F%2Fpaulfioravanti.com%2Fblog%2F2020%2F02%2F03%2Finternationalisation-with-phoenix-live-layouts%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fpaulfioravanti.com%2Fblog%2F2020%2F02%2F03%2Finternationalisation-with-phoenix-live-layouts%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fpaulfioravanti.com%2Fblog%2F2020%2F02%2F03%2Finternationalisation-with-phoenix-live-layouts%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a> </section> <nav class="pagination"> <a href="/blog/2020/01/27/internationalisation-with-phoenix-live-components/" class="pagination--pager" title="Internationalisation with Phoenix LiveComponents ">Previous</a> <a href="#" class="pagination--pager disabled">Next</a> </nav> </div> <div class="page__comments"> <h4 class="page__comments-title">Comments</h4> <section id="disqus_thread"></section> </div> </article> <div class="page__related"> <h4 class="page__related-title">You May Also Enjoy</h4> <div class="grid__wrapper"> <div class="grid__item"> <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork"> <div class="archive__item-teaser"> <img src="/assets/images/2020-01-27/jason-leung-jCBzW_Q_UGI-unsplash.jpg" alt="photo of assorted-color nation flags on wall during daytime"> </div> <h2 class="archive__item-title" itemprop="headline"> <a href="/blog/2020/01/27/internationalisation-with-phoenix-live-components/" rel="permalink">Internationalisation with Phoenix LiveComponents </a> </h2> <p class="page__meta"> <i class="fa fa-calendar-alt" aria-hidden="true"></i> <time datetime="2020-01-27T10:00:00+11:00"> Jan 27, 2020 </time> &nbsp; <i class="far fa-clock" aria-hidden="true"></i> 17 minute read </p> <p class="archive__item-excerpt" itemprop="description">Draw the responsibility demarcation lines between your LiveView-managed state, markup, and events with LiveComponents. </p> </article> </div> <div class="grid__item"> <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork"> <div class="archive__item-teaser"> <img src="/assets/images/2020-01-08/allie-smith-vuWCq1bXZy0-unsplash.jpg" alt="cup of coffee on laptop"> </div> <h2 class="archive__item-title" itemprop="headline"> <a href="/blog/2020/01/08/employee-sans-office/" rel="permalink">Employee Sans Office </a> </h2> <p class="page__meta"> <i class="fa fa-calendar-alt" aria-hidden="true"></i> <time datetime="2020-01-08T16:45:00+11:00"> Jan 08, 2020 </time> &nbsp; <i class="far fa-clock" aria-hidden="true"></i> 4 minute read </p> <p class="archive__item-excerpt" itemprop="description">Small thoughts on remote working. </p> </article> </div> <div class="grid__item"> <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork"> <div class="archive__item-teaser"> <img src="/assets/images/2019-11-03/nareeta-martin-vF1YCoLHMpg-unsplash.jpg" alt="multicolored buntings on pathway"> </div> <h2 class="archive__item-title" itemprop="headline"> <a href="/blog/2019/11/03/internationalisation-with-phoenix-liveview/" rel="permalink">Internationalisation with Phoenix LiveView </a> </h2> <p class="page__meta"> <i class="fa fa-calendar-alt" aria-hidden="true"></i> <time datetime="2019-11-03T00:00:00+11:00"> Nov 03, 2019 </time> &nbsp; <i class="far fa-clock" aria-hidden="true"></i> 46 minute read </p> <p class="archive__item-excerpt" itemprop="description">Change your application locale without a full-page reload or having to write (much) Javascript. </p> </article> </div> <div class="grid__item"> <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork"> <div class="archive__item-teaser"> <img src="/assets/images/2019-06-22/drew-beamer-692664-unsplash.jpg" alt="black rolling chairs beside brown table"> </div> <h2 class="archive__item-title" itemprop="headline"> <a href="/blog/2019/06/22/resume-as-code/" rel="permalink">Resume as Code </a> </h2> <p class="page__meta"> <i class="fa fa-calendar-alt" aria-hidden="true"></i> <time datetime="2019-06-22T21:00:00+10:00"> Jun 22, 2019 </time> &nbsp; <i class="far fa-clock" aria-hidden="true"></i> 9 minute read </p> <p class="archive__item-excerpt" itemprop="description">Bring some fun back into the document that sells you to the world. </p> </article> </div> </div> </div> </div> </div> <div id="footer" class="page__footer"> <footer> <div class="page__footer-follow"> <ul class="social-icons"> <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li> </ul> </div> <div class="page__footer-copyright">&copy; 2020 Paul Fioravanti. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div> </footer> </div> <script src="/assets/js/main.min.js"></script> <script src="https://kit.fontawesome.com/4eee35f757.js"></script> <script>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-109270947-1"]),_gaq.push(["_trackPageview"]),function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}();</script> <script>var disqus_config=function(){this.page.url="https://paulfioravanti.com/blog/2020/02/03/internationalisation-with-phoenix-live-layouts/",this.page.identifier="/blog/2020/02/03/internationalisation-with-phoenix-live-layouts"};!function(){var t=document,i=t.createElement("script");i.src="https://paulfioravanti.disqus.com/embed.js",i.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(i)}();</script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </body> </html>